<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
  <script src="//code.jquery.com/jquery-1.10.2.js"></script>
  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  <style type="text/css">
    #map-canvas { height: 500px; width: 500px; margin: 0; padding: 0;}
    </style>
 
    <%= javascript_tag do %>
      var resPins = <%= @itinerary.res_pins %>;
      var mealPins = <%= @itinerary.meal_pins %>;
      var activityPins = <%= @itinerary.activity_pins %>;
      var firstRes = <%= @first_res %>;
    <% end %>
    <script src="https://maps.googleapis.com/maps/api/js?key=<%="#{ENV["GOOGLE_KEY"]}"%>"></script>
<script>
  var myLatlng = new google.maps.LatLng(firstRes[0], firstRes[1]);
  $(function() {
    initialize()
    $.each (resPins, function(i, res) {
      addPin(res);
    })
    $.each (mealPins, function(i, res) {
      addPin(res);
    })
    $.each (activityPins, function(i, res) {
      addPin(res);
    })
    }
  )
</script>
 <br><br>   
<div id="map-canvas"></div>





<h1> <%= @itinerary.title %></h1>
    <%= @itinerary.start_date.strftime("%B %d, %Y")%> - <%= @itinerary.end_date.strftime("%B %d, %Y")%><br><br><br><br> 
<div id="owl-demo" class="owl-carousel owl-theme">
<% @itinerary.itinerary_item_photos.each do |photo| %>
  <div class="item"><%= image_tag(photo.url)%> </center></div>
<% end %>
</div>

<table class="table table-bordered">
    <% if @itinerary_dates.count < 8 %>
      <%= render 'itinerary_items' %>
    <% else %>
      <%= render 'itinerary_item_two' %>
    <% end%>
</table>

<div class="row">
  <div class = "col-md-4">
    <h3><%= link_to @itinerary.user.name, user_path(@itinerary.user) %></h3>
    <%= image_tag @itinerary.user.avatar.url(:medium) %><br><br>
    <% if current_user == @itinerary.user %>
      <h3>Add items to your itinerary!</h3><br><br>
      <%= button_to "Add a Hotel Reservation", new_itinerary_hotel_path(@itinerary),  :method => "get", class: "btn btn-primary" %><br>
      <%= button_to "Add a Restaurant", new_itinerary_restaurant_path(@itinerary),  :method => "get", class: "btn btn-primary" %><br>
      <%= button_to "Add an Attraction", new_itinerary_attraction_path(@itinerary),  :method => "get", class: "btn btn-primary" %>
    <% end %>
  </div>
</div>
<script>
  $(function() {
    $( "#sortable1, #sortable2" ).sortable({
      connectWith: ".connectedSortable",
      stop: function(event, ui) {
        var order = $(this).parent().children($('#sortable1')).sortable('toArray').toString();
        $.ajax({
          url: '/update_position',
          method: 'PUT',
          dataType: 'json',
          data: {
            data: order,
            itinerary_item_id: ui.item.prop('id')
          }
        })
      }
    });
  });
  
  $(document).ready(function(){
  setTimeout(function(){
    $('#flash-wrapper').fadeOut();}, 1200);
});

</script>